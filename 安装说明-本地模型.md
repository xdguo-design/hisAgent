# 安装本地模型依赖说明

## 当前状态

⚠️ **检测到错误**：`No module named 'llama_index.embeddings.huggingface'`

这是因为你选择了本地免费模型，但系统还没有安装必要的依赖库。

## 正在安装中

系统正在后台安装以下依赖库：
- ✅ llama-index-embeddings-huggingface（HuggingFace模型集成）
- ✅ sentence-transformers（句子转换器）
- ✅ transformers（Transformers库）
- ✅ torch（PyTorch深度学习框架）

**预计时间**：
- PyTorch较大（~2GB），首次安装需要5-15分钟
- 取决于网络速度

## 两个选项

### 选项1：等待安装完成（推荐）

**优点**：
- ✅ 完全免费
- ✅ 无需API密钥
- ✅ 中文效果好
- ✅ 数据隐私

**步骤**：
1. 等待安装完成（查看终端进度）
2. 重启服务器
3. 重新创建知识库，选择本地免费模型

### 选项2：先使用智谱AI模型

如果你已经充值智谱AI，可以先用智谱模型：

**步骤**：
1. 在"创建知识库"对话框中
2. 将"嵌入模型"改为：**zhipuai-embedding**
3. 继续创建知识库

## 检查安装进度

查看终端3的输出，应该看到类似：

```
Collecting llama-index-embeddings-huggingface
Downloading llama_index_embeddings_huggingface-0.1.0-py3-none-any.whl
...
Successfully installed llama-index-embeddings-huggingface-0.1.0
```

## 安装完成后的操作

安装完成后需要：

1. **重启服务器**（重要！）
   - 停止当前服务器（Ctrl+C）
   - 重新运行：`python start.py`

2. **重新创建知识库**
   - 选择本地免费模型（如：BGE-base-zh-v1.5）
   - 这次应该能成功创建

## 临时使用智谱AI模型

如果不想等待，可以先用智谱AI模型：

1. 在创建知识库对话框中
2. 嵌入模型选择：**zhipuai-embedding**
3. 继续创建

注意：需要确保智谱AI账户有余额。

## 推荐的本地模型

安装完成后，推荐使用：

### BGE-base-zh-v1.5（中文，平衡）⭐ 推荐
- **模型标识**：`local-BAAI/bge-base-zh-v1.5`
- **特点**：
  - 速度和精度平衡
  - 优秀的中文语义理解
  - 适合大多数应用
- **首次使用**：会自动下载模型文件（~400MB）

### BGE-small-zh-v1.5（快速）
- **模型标识**：`local-BAAI/bge-small-zh-v1.5`
- **特点**：快速轻量，适合测试

### BGE-large-zh-v1.5（高精度）
- **模型标识**：`local-BAAI/bge-large-zh-v1.5`
- **特点**：最高精度，资源占用较高

## 常见问题

### Q: 安装需要多长时间？
A: 首次安装PyTorch需要5-15分钟，取决于网络速度。使用清华镜像源会快一些。

### Q: 可以中断安装吗？
A: 不建议。让安装完成，否则可能需要重新开始。

### Q: 安装完成后还需要做什么？
A: 需要重启服务器才能使用新安装的库。

### Q: 首次使用本地模型会很慢吗？
A: 首次使用会下载模型文件（~400MB），之后的处理速度会很快。

## 当前任务

1. ⏳ **等待安装完成**（终端3）
2. 🔄 **重启服务器**
3. ✅ **重新创建知识库**
4. 🎉 **享受免费本地模型**

## 安装进度监控

定期检查终端3的输出：
- 如果看到 "Successfully installed"，说明安装完成
- 如果看到错误信息，请截图联系技术支持